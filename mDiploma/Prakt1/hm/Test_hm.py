import random
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import sympy

# входные значения
INPUT_DIM1=2 # 2 признака
# переход на H1 множества
OUT_DIM1=5 # 5 классов
# переход в t1
H_DIM1=5
#вход H2 правила
INPUT_DIM2=5
#переход в t3
H_DIM2=3
#переход в t4
H_DIM3=3    
  

def sigmoid(t):
    return 1/(1+np.exp(-t))

def softmax(t):
    out=np.exp(t)
    return out/np.sum(out)


def predict(a,b):
    x=np.array([[a,b]])
    print('На вход подали Х= ',x)
    if(0<=a<=6)and(0<=b<=6):
        W1= np.array(
        [[ 0.59167201,  0.45970353,  0.10406684, 0.29610135, -0.49545605],
         [-0.62081247, -0.62632746,  0.5628228,  -0.67786301, -0.07804257]] )
        W2= np.array(
        [[-0.22966768,  0.03591184, -0.31349519,  0.04262993,  0.14971683],
         [ 0.06206487, -0.35157254,  0.3441993,   0.37086445,  0.08823546],
         [ 0.14993893,  0.27562119, -0.03259015, -0.17417634,  0.25860841],
         [-0.09222725, -0.35238941, -0.41491459,  0.16421733,  0.4167085 ],
         [-0.08823161,  0.35114004, -0.10495345,  0.23851697, -0.04151523]] )
        b1= np.array(
        [[-0.00339545,  0.38160016,  0.48561267,  0.08669277,  0.29496599]] )
        b2= np.array(
        [[-0.33906602,  0.10394421, -0.25202703, -0.47458642, -0.17021743]] )
        W3= np.array(
        [[ 105.94551549, -175.34843137, -228.42521886],
         [ 135.25713866, -143.24370591, -306.81017901],
         [ 149.19407541, -256.03215654, -127.20079825],
         [  43.45404006, -106.72378908, -133.09870243],
         [ 106.31345166, -276.74499408, -240.74053915]] )
        b3= np.array(
        [[ 384.89104341 -282.5343171  -232.01139997]] )
        W4= np.array(
        [[ 0.60165531, -0.84540326, -1.0803728 ],
         [ 0.77162284, -0.72358552, -1.44722115],
         [ 0.7860327,  -1.19886143, -0.62911114],
         [ 0.33049144, -0.54433852, -0.66145227],
         [ 0.65692295, -1.32057966, -1.16185718]] )
        b4= np.array(
        [[ 2.02793224, -1.41548631, -1.19262736]])

    
    if(7<=a<=14)and(0<=b<=6):
        W1= np.array(
        [[ 0.34949033,  0.55367941, -0.16723136,  0.41359531, -0.5694882 ],
         [-0.02392101, -0.15408158,  0.19002348, -0.57483974,  0.25991109]] )
        W2= np.array(
        [[ 0.2040654,   0.29177505,  0.32308946,  0.39579939,  0.12334538],
         [ 0.43573355,  0.29617185,  0.40273616,  0.14538216, -0.30610831],
         [ 0.20833091, 0.15398035, -0.08972844,  0.13165045, -0.22581039],
         [-0.24533297, -0.41523739,  0.31718192, -0.32763572,  0.01874636],
         [ 0.15936418, -0.05606482,  0.20288695,  0.12224047, -0.09480456]] )
        b1= np.array(
        [[-0.34311372, -0.06828099,  0.4829784,   0.34207225, -0.60260751]] )
        b2= np.array(
        [[ 0.17274908, -0.0642839,   0.33464533,  0.32890659,  0.18631287]] )
        W3= np.array(
        [[-221.57305533,  107.66121799, -236.11369183],
         [-172.41933153,    9.12232448, -230.35272617],
         [-167.42048632,  208.87711794, -234.57482827],
         [-217.47876574,  123.7151332,  -113.49330778],
         [-119.46485542,  114.97128725, -183.04821784]] )
        b3= np.array(
        [[-350.9558593,   152.74229539, -311.6930406 ]] )
        W4= np.array(
        [[-1.06117021,  0.62548141, -1.11933458],
         [-0.83030725,  0.16378165, -1.08147568],
         [-0.83736604,  1.1034781,  -1.12703345],
         [-1.04166364,  0.69381696, -0.57561945],
         [-0.58904617,  0.6185414,  -0.86574857]] )
        b4= np.array(
        [[-1.67500382,  0.90463357, -1.4919099 ]] )   
    
        
    if(7<=b<=14)and(0<=a<=6):
        W1= np.array(
        [[-0.64692977,  0.68407288, -0.24425661,  0.01181531,  0.14836306],
         [-0.45505989, -0.58433528,  0.47946632,  0.08410901, -0.31325435]] )
        W2= np.array(
        [[-0.40886713,  0.42773411,  0.21711106,  0.44637118,  0.31193783],
         [-0.31944761, -0.336825,   -0.34759835, -0.15043149,  0.43379514],
         [ 0.1773107,  -0.3670244,   0.2338412,  -0.26494956,  0.49902102],
         [-0.32264073,  0.40704887, -0.24493938, -0.17908565,  0.37451315],
         [ 0.35548556,  0.16364881, -0.31072743,  0.03075284, -0.04001547]] )
        b1= np.array(
        [[-0.37817617, -0.35859075,  0.70681809, -0.65670247, -0.28802649]] )
        b2= np.array(
        [[-0.11442669, -0.15154611,  0.24528718, -0.34720186, -0.25433208]] )
        W3= np.array(
        [[-151.92356985,  123.35788817, -255.88824983],
         [-224.12664815,  -20.63866807, -181.65764769],
         [-138.67376012,  168.06565796, -241.52534847],
         [-160.01489319,  113.58330933, -101.59240186],
         [-275.1102326,   182.43288058, -285.7233748 ]] )
        b3= np.array(
        [[-308.65246837,  314.90070324, -233.10498697]] )
        W4= np.array(
        [[-0.74788311,  0.69005389, -1.20712884],
         [-1.06039207,  0.03934296, -0.87192924],
         [-0.70566525,  0.92046712, -1.15983994],
         [-0.76143036,  0.60252157, -0.50253192],
         [-1.31467936,  0.99491359, -1.36077936]] )
        b4= np.array(
        [[-1.52343017,  1.70110824, -1.18784678]] )

   
    if(15<=a<=20)and(7<=b<=14):
        W1= np.array(
        [[-0.31043429,  0.14181067,  0.47416026, -0.61409655,  0.05959806],
         [-0.44562023, -0.58370948,  0.15650333, -0.66723959,  0.44139362]] )
        W2= np.array(
        [[ 0.1858082,   0.36677114,  0.10034062,  0.3478891,   0.44332643],
         [ 0.25681397,  0.2110159,  -0.24554142,  0.23485362,  0.27775313],
         [ 0.0174409,  -0.19724236,  0.22252578, -0.11655019,  0.06117243],
         [-0.05327518, -0.01254078, -0.21683441, -0.40903737, -0.34718702],
         [ 0.28635098, -0.25121193, -0.08112644, -0.12310495,  0.34869279]] )
        b1= np.array(
        [[-0.02925408, -0.26628437, -0.21889806, -0.27155029, -0.27310952]] )
        b2= np.array(
        [[ 0.02249325, -0.0070445,   0.45496943, -0.28612627, -0.23832616]] )
        W3= np.array(
        [[-137.52872175, -181.48299165,   63.07589602],
         [-229.48077856, -173.86188662,   -5.61956638],
         [-232.77014115, -223.86806377,  210.44749991],
         [-118.62845313, -140.03346331,   98.20399973],
         [-190.73175825, -149.80345428,   84.17408867]] )
        b3= np.array(
        [[-317.42863597, -301.06242913,  379.51944241]] )
        W4= np.array(
        [[-0.69063943, -0.89737658,  0.4492119 ],
         [-1.07099474, -0.83319781,  0.08845424],
         [-1.12009778, -1.09426077,  1.11866334],
         [-0.57832534, -0.68089878,  0.54278014],
         [-0.92077577, -0.75122076,  0.53131102]] )
        b4= np.array(
        [[-1.54369876, -1.49239156,  1.97232975]] )   

    
    if(15<=b<=20)and(7<=a<=14):
        W1= np.array(
        [[ 0.36963952, -0.19317998, -0.32819803, -0.36717528, 0.67067535],
         [ 0.56432324, -0.13130767,  0.53746368, -0.38518461, 0.54051272]] )
        W2= np.array(
        [[-0.29149089,  0.16471759,  0.37682994,  0.25568465, -0.35933487],
         [-0.11454296, -0.43899844,  0.07840151, -0.37415216, -0.40366189],
         [-0.28621416, -0.29959151, -0.20358821, -0.16819771,  0.07032713],
         [-0.31264809,  0.14915079,  0.18986306,  0.3420358,  -0.34156552],
         [-0.40428158,  0.20023412, -0.02678463,  0.30144024, -0.04432993]] )
        b1= np.array(
        [[0.61477037, 0.06468919, 0.45100555, 0.50071254, 0.36817005]] )
        b2= np.array(
        [[0.22108732, 0.4628345,  0.35644763, 0.42926289, 0.0988399 ]] )
        W3= np.array(
        [[ -83.80209008, -140.13341434,  -48.1154311 ],
         [-263.65872951, -216.33431445,  130.44721965],
         [-143.30472133, -214.4125722,    98.60706708],
         [-161.0875828,  -289.61541776,  142.5621833 ],
         [-275.50908745, -122.31061071,   -8.11969406]] )
        b3= np.array(
        [[-324.50407523, -273.80987232,  354.86540345]] )
        W4= np.array(
        [[-0.416661,   -0.66517899, -0.12825164],
         [-1.25468841, -1.04401962,  0.74580669],
         [-0.72180229, -1.03504274,  0.60399847],
         [-0.80991408, -1.3770151,   0.8171888 ],
         [-1.28137867, -0.6027558,   0.08176813]] )
        b4= np.array(
        [[-1.57505444, -1.3486923,   1.84018187]] )
    
  
    if(15<=a<=20)and(15<=b<=20):
        W1= np.array(
        [[-0.65762383, -0.13771372, -0.22610302,  0.57390524, -0.49065634],
         [-0.37567505, -0.06965969, -0.3140554,   0.11563561, -0.49785043]] )
        W2= np.array(
        [[-0.39799212, -0.05237088, -0.42297131, -0.13136759, -0.05550747],
         [ 0.19363933,  0.32367252,  0.03647605,  0.30621216, -0.06893507],
         [-0.33835828, -0.25206658,  0.3591077,   0.01599735,  0.29425805],
         [-0.22213282, -0.34199653, -0.38858675, -0.00401298,  0.26541713],
         [-0.38024671,  0.26396661, -0.25579229, -0.19434161,  0.20394744]] )
        b1= np.array(
        [[ 0.23515017, -0.67912694,  0.36757841, -0.2806407, 0.21968695]] )
        b2= np.array(
        [[ 0.43728362,  0.49844649,  0.24402616, -0.22919839, -0.36796098]] )
        W3= np.array(
        [[-126.9745886,  -226.45824434,  181.4060852 ],
         [-279.70090016, -247.21306094,  123.72780953],
         [-240.5318496,  -154.34962883,   12.83799358],
         [-234.88420581, -109.3003752,     4.52297351],
         [-216.41491142, -282.93492066,   41.09951014]] )
        b3= np.array(
        [[-301.53765667, -312.31875085, 362.93810872]] )
        W4= np.array(
        [[-0.6463491,  -1.09233403,  0.97106278],
         [-1.31986338, -1.18190349,  0.71157987],
         [-1.13528067, -0.75898757,  0.19760886],
         [-1.10717994, -0.55636525,  0.15436809],
         [-1.03008158, -1.32939368,  0.32570404]] )
        b4= np.array(
        [[-1.48487207, -1.54322073,  1.9114844 ]]  )  
     
    if(15<=a<=20)and(0<=b<=6):
        W1= np.array(
        [[ 0.26724521,  0.23549377, -0.35965464, -0.14692366,  0.18874954],
         [ 0.01097913, -0.42369215,  0.27045072, -0.1168319,   0.56341938]] )
        W2= np.array(
        [[-0.38781906,  0.1928833,  -0.14482183, -0.00856598, -0.20416842 ],
         [ 0.38199109, -0.28461923,  0.18076324, -0.35787059, -0.08952894 ],
         [-0.13525238,  0.2269835,   0.00097707,  0.157263,    0.00085396 ],
         [-0.17886547, -0.38060285,  0.00278659,  0.14896943,  0.16592825 ],
         [ 0.02366394, -0.0170232,   0.05130508,  0.14267515,  0.31329051]] )
        b1= np.array(
        [[-0.69801999, -0.63955962, -0.58263972,  0.1474073,  -0.6143484 ]] )
        b2= np.array(
        [[ 0.41840043,  0.48009029,  0.33229618, -0.35577279, -0.2190881 ]] )
        W3= np.array(
        [[-212.54951896, -303.95202896,  104.80815873],
         [-247.74119529, -186.73541429,  158.4098148 ],
         [-252.47821516, -250.85879133,  179.11371515],
         [-104.22420736, -107.38683831,   29.925762  ],
         [-164.97678643, -254.40228505,   55.34057935]] )
        b3= np.array(
        [[-293.56047746, -232.03629557,  274.5264836 ]] )
        W4= np.array(
        [[-1.02819667, -1.43341811,  0.63379481],
         [-1.18337778, -0.91439964,  0.86992107],
         [-1.2052456,  -1.19897696,  0.96333905],
         [-0.51655662, -0.53110474,  0.2373151 ],
         [-0.79743628, -1.19370478,  0.37412934]] )
        b4= np.array(
        [[-1.4447812,  -1.17411876,  1.50161922]])
    
    
    if(15<=b<=20)and(0<=a<=6):
        W1= np.array(
        [[ 0.41938519, -0.10849576,  0.70512484, -0.25603208, -0.19817141],
         [-0.21624665, -0.03681507, -0.3384337,   0.19232779,  0.41532654]] )
        W2= np.array(
        [[-0.3195875, -0.28484082, -0.05816345, -0.04831669, -0.3250193 ],
         [ 0.21238323,  0.28728858,  0.32365042, -0.40036041, -0.36506375 ],
         [-0.25346275, -0.10228269, -0.07953537,  0.06980243,  0.14265182 ],
         [-0.11335072, -0.35490666,  0.06671258, -0.03752247, -0.03124599 ],
         [ 0.37243353, -0.20007732,  0.05865093,  0.41162299, -0.17872455 ]] )
        b1= np.array(
        [[ 0.44458318,  0.30765415, -0.68085859,  0.45562656,  0.67629368]] )
        b2= np.array(
        [[-0.25386693,  0.4171025,   0.28255237,  0.03253466, -0.29009086]] )
        W3= np.array(
        [[-196.99055259, -172.62494498,   45.86166619 ],
         [-148.32361871, -156.65363247,  157.76671538 ],
         [-212.06854045, -299.35324248,  149.55830583 ],
         [-281.5038246,  -214.32736617,   66.02391108 ],
         [-144.88423311, -153.91379809,   99.2141771 ]] )
        b3= np.array(
        [[-358.62722185, -346.97710204,  262.11487096]] )
        W4= np.array(
        [[-0.94964626, -0.84197617,  0.35281565 ],
         [-0.73075859, -0.76771707,  0.84063337 ],
         [-1.03344714, -1.41970566,  0.84576257 ],
         [-1.33162847, -1.03459537,  0.45827448 ],
         [-0.69364366, -0.7336651,   0.53778562 ]] )
        b4= np.array(
        [[-1.73766811, -1.68636266,  1.45555638]] )   
    
    #Forward
    t1= x@W1 + b1
    h1= sigmoid(t1)
    t2= h1@W2 + b2
    h2= sigmoid(t2)
    t4= h2@W4 + b4
    h4=softmax(t4)
    t3= h2@W3 + b3
    z=softmax(t3)
    return z
    
class_names=['1) Т_ц=60сек, t_з=30сек','2) Т_ц=120сек, t_з=60сек','3) Т_ц=240сек, t_з=120сек']

probs= predict(9,5)
pred_class= np.argmax(probs)
print('Pred_class= ',pred_class)
print('PREDICT светофор ',class_names[pred_class])

probs= predict(4,3)
pred_class= np.argmax(probs)
print('Pred_class= ',pred_class)
print('PREDICT светофор ',class_names[pred_class])

probs= predict(5,7)
pred_class= np.argmax(probs)
print('Pred_class= ',pred_class)
print('PREDICT светофор ',class_names[pred_class])

probs= predict(20,20)
pred_class= np.argmax(probs)
print('Pred_class= ',pred_class)
print('PREDICT светофор ',class_names[pred_class])

