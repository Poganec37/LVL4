import random
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import sympy

#вход а 2 направления
INPUT_X=2
#переход t1 (W1,b1)
OUT_H1=5
#переход t2 (W2,b2)
OUT_H2=6
#светофор t3 (W3, b3)
OUT_t3=3  
  

def sigmoid(t):
    return 1/(1+np.exp(-t))

def softmax(t):
    out=np.exp(t)
    return out/np.sum(out)


def predict(a,b):
    x=np.array([[a,b]])
    print('На вход подали Х= ',x)

    if(0<=a<7)and(0<=b<7):
        W1= np.array(
        [[-0.62484996,  0.6376105,  -0.58451638, -0.08852041,  0.49177051],
         [-0.18945752,  0.14679312, -0.66532984,  0.21165716,  0.01052517]] )
        W2= np.array(
        [[ 0.16960337, -0.05887696, -0.20370038, -0.04674722, -0.02641826,  0.21377165],
         [-0.35989031, -0.11619445, -0.16344819, -0.21878047,  0.2327819,   0.09432964],
         [-0.02511597,  0.03184724, -0.35229866,  0.32056548, -0.045102,    0.20306614],
         [-0.19300063,  0.3491241,   0.01558142, -0.13743798, -0.33457478,  0.39820336],
         [ 0.14441377,  0.2593752,   0.3360195,   0.08988242, -0.15082186, -0.2350883 ]] )
        b1= np.array(
        [[ 0.65516596, -0.48154249,  0.23437839, -0.52561682, -0.55658742]] )
        b2= np.array(
        [[ 0.00627589, -0.19709519,  0.26965818,  0.42431855,  0.39822825,  0.3703449 ]] )
        W3= np.array(
        [[  54.57636526, -192.17239672, -261.95186466],
         [   9.1967569,  -296.0725049, -215.0475318 ],
         [ -73.81672665, -303.96528186, -213.81856848],
         [ 133.70588202, -171.92569752, -311.86891487],
         [   8.26695351, -215.72327488, -329.59850586],
         [   4.39812683, -360.74740093, -137.48195764]] )
        b3= np.array(
        [[ 184.30902327, -331.47289198, -392.27105571]] )
        W4= np.array(
        [[ 0.34587456, -0.90690845, -1.21503872],
         [ 0.15975777, -1.37451214, -1.01469578],
         [-0.19273427, -1.41710115, -1.01675781],
         [ 0.72594251, -0.8321896,  -1.45079165],
         [ 0.1729593,  -1.02742379, -1.53056853],
         [ 0.16851959, -1.67605768, -0.68607579]] )
        b4= np.array(
        [[ 1.05335076, -1.59082785, -1.85809638]] )

    if(6<a<15)and(0<=b<7):
        W1= np.array(
        [[ 0.17268753, -0.55472504, -0.64567,    -0.63612469,  0.06809078],
         [ 0.5257601,   0.34560234, -0.03920125, -0.00680454,  0.59387095]] )
        W2= np.array(
        [[-0.01046141,  0.15264254,  0.44703039,  0.0854465,   0.05803878,  0.07274277],
         [-0.2033749,   0.24564688, -0.02772024, -0.21586929,  0.05501212,  0.25983928],
         [-0.30886688,  0.3846209,   0.1419291,  -0.30951477, -0.2766376,   0.36763949],
         [ 0.17819819, -0.20536513, -0.29319797, -0.35767968,  0.38888821, -0.28602522],
         [ 0.12085895, -0.41776185,  0.10242995,  0.33574312, -0.27491205,  0.29776898]] )
        b1= np.array(
        [[0.32812598, 0.01263583, 0.30845397, 0.56200459, 0.69203444]] )
        b2= np.array(
        [[ 0.45839182,  0.11118509, -0.00081094, -0.33381061,  0.10885556,  0.09916329]] )
        W3= np.array(
        [[-329.12910645,  208.51244853, -129.37897704],
         [-193.80884471,  -36.68762558, -106.37426748],
         [-213.78617529,  220.38402888, -370.02195729],
         [-239.07460096,  -34.01715993, -167.25789877],
         [-234.41349274,   54.33047998, -310.77390585],
         [ -88.86049563,  222.78942005, -112.67194015]] )
        b3= np.array(
        [[-195.14891599,  129.01085055, -255.00741786]] )
        W4= np.array(
        [[-1.53639425,  1.07306105, -0.65043528],
         [-0.91705463, -0.05259894, -0.52884824],
         [-1.02452552,  1.1235265,  -1.71509649],
         [-1.12279041, -0.03032195, -0.80365411],
         [-1.09796061,  0.35263322, -1.4351145 ],
         [-0.46926245,  1.13017469, -0.57341685]] )
        b4= np.array(
        [[-0.98699612,  0.8080952,  -1.24996035]] )

    if(6<b<15)and(0<=a<7):
        W1= np.array(
        [[ 0.55810415,  0.11815855,  0.55285585,  0.30244242,  0.5577303 ],
         [-0.25631744, -0.48661642, -0.62950007, -0.5644812,  -0.4665927 ]] )
        W2= np.array(
        [[ 0.09106568, -0.18932234, -0.37507979, -0.36133716,  0.18569024,  0.37251875],
         [-0.37822224,  0.18498916, -0.35972452, -0.23843046,  0.03021551, -0.31772095],
         [ 0.1897053,   0.26477027, -0.1398694,  -0.30002351,  0.14201539,  0.27407167],
         [ 0.36053045, -0.362399,   -0.08704214,  0.24986831, -0.03915364,  0.3944467 ],
         [ 0.00602307, -0.12895823, -0.33848563, -0.30699762,  0.13915231,  0.17205723]] )
        b1= np.array(
        [[ 0.02212935, -0.31234198,  0.42555393, -0.23988107,  0.57797707]] )
        b2= np.array(
        [[-0.15200602, -0.28800935,  0.14411414, -0.32097475, -0.00460135,  0.05343892]] )
        W3= np.array(
        [[-227.88698776,  135.09816955, -244.95484369],
         [-117.06274179,    3.52429426, -210.32609219],
         [-191.90328117,  -51.31649297, -321.80825725],
         [-335.8155871,   -84.76088869,  -87.68928985],
         [-303.51637197,  118.5798082,  -263.07250151],
         [-265.24456217,  -70.31827485, -323.64763623]] )
        b3= np.array(
        [[-316.60723585,  379.67727292, -278.88171021]] )
        W4= np.array(
        [[-1.07804283,  0.73274016, -1.15706495],
         [-0.57943089,  0.13404554, -0.99551748],
         [-0.92308308, -0.08372376, -1.50210775],
         [-1.54449376, -0.26449702, -0.44854758],
         [-1.41952003,  0.67300564, -1.24417237],
         [-1.25410651, -0.15520092, -1.51670161]] )
        b4= np.array(
        [[-1.54622536,  1.97034387, -1.3865006 ]] )

    if(6<b<10)and(6<a<10):
        W1= np.array(
        [[ 0.65605257, -0.49530872,  0.63287887, -0.32929763,  0.60578418],
         [ 0.43339223,  0.44496643, -0.02018984, -0.40916755, -0.12583323]] )
        W2= np.array(
        [[ 0.0653512,  -0.31443982, -0.4080181,  -0.14906696, -0.39995651,  0.20704214],
         [ 0.22281254,  0.22303444, -0.36699824, -0.15884642, -0.148648,    0.28628325],
         [-0.09851481, -0.14453802,  0.25144476, -0.45353712, -0.27242362, -0.27730502],
         [ 0.15209174, -0.3896298,   0.3337373,  -0.04013097,  0.34862544,  0.22914982],
         [ 0.16788407,  0.18640929, -0.1934287,  -0.35008361,  0.2216866,  -0.13113124]] )
        b1= np.array(
        [[ 0.13167317, -0.24321803, -0.64040699, -0.39395382,  0.42581301]] )
        b2= np.array(
        [[-0.01901818,  0.33858995,  0.14045661, -0.14738383,  0.19554015,  0.06265102]] )
        W3= np.array(
        [[-118.45807382,  136.03219582, -304.79474862],
         [-371.74899645,   53.60642038, -261.98945843],
         [-281.20615168,  -37.81917765, -174.2209333 ],
         [ -57.58180151,  -51.42904483, -136.11398309],
         [-152.9551622,    10.13350586, -214.57540887],
         [-274.82874111,  -65.00426961, -166.98786437]] )
        b3= np.array(
        [[-429.31668284,  324.6256032,  -424.13242852]] )
        W4= np.array(
        [[-0.60854086,  0.76898046, -1.43906193],
         [-1.72839932,  0.4001097,  -1.24751425],
         [-1.30959066, -0.04159687, -0.83983577],
         [-0.29334029, -0.15537979, -0.64347766],
         [-0.74285554,  0.17331389, -1.01986264],
         [-1.2928141,  -0.13830813, -0.82001733]] )
        b4= np.array(
        [[-2.05259579,  1.7433557,  -2.03933987]] )

    if(14<a<21)and(6<b<15):
        W1= np.array(
        [[-0.64820295,  0.15774778,  0.10805002, -0.67031682,  0.01988139],
         [-0.47834008, -0.7091542,  -0.69552635,  0.05085867,  0.56091965]] )
        W2= np.array(
        [[-0.10584283,  0.21814406,  0.16200429, -0.35664519,  0.18398534, -0.14705856],
         [-0.14256881, -0.37795364,  0.15483795,  0.05323577,  0.31912523,  0.37632552],
         [ 0.30301187, -0.00616583,  0.31267735, -0.37085696, -0.16120288, -0.09748918],
         [ 0.2944343,   0.26422634,  0.0769755,   0.09672141,  0.20429601,  0.18771675],
         [-0.04791842,  0.13199104,  0.27066856,  0.43101917, -0.3159231,  -0.06406142]])
        b1= np.array(
        [[ 0.57713789, -0.36419808, -0.35292889,  0.45007555,  0.23705989]] )
        b2= np.array(
        [[ 0.34652194,  0.18283203, -0.23669925, -0.03051827,  0.29911403, -0.17357534]])
        W3= np.array(
        [[-187.81376279, -231.66603077,   52.70611716],
         [-252.77853468, -359.5293055,    90.92627819],
         [-130.28955741, -243.64821321,  -41.74651017],
         [-225.32984804, -106.66168915,  217.97731383],
         [-136.94760719, -289.48069063,  -77.66280824],
         [-172.31735352, -157.74108108,  112.54227571]])
        b3= np.array(
        [[-425.89112499, -288.97064459,  203.52551629]] )
        W4= np.array(
        [[-0.90754303, -1.09982286,  0.37643652],
         [-1.19548444, -1.66630984,  0.54617157],
         [-0.64454439, -1.14485385, -0.05813563],
         [-1.07670737, -0.54917414,  1.11431755],
         [-0.67242977, -1.3462681,  -0.22035268],
         [-0.82203687, -0.75600253,  0.60810886]] )
        b4= np.array(
        [[-2.01646063, -1.40674719,  1.15207156]])

    if(14<b<21)and(6<a<15):
        W1= np.array(
        [[-0.02555218, -0.60547795, -0.38894449, -0.16786541,  0.3271768 ],
         [-0.24215428, -0.00167193, -0.65359232,  0.32047498,  0.33149464]] )
        W2= np.array(
        [[ 1.43356806e-02,  2.37523288e-01,  1.03600711e-01, -2.37179517e-01,
          -7.03597365e-02,  7.25189520e-02],
         [ 9.59349385e-02,  3.97424416e-01,  5.75755529e-02, -1.50550362e-01,
          -1.06108064e-02,  1.62669104e-01],
         [ 6.53152930e-02, -4.04455629e-01, -1.62513188e-01,  2.18742217e-01,
          -2.17356289e-01, -2.85786625e-01],
         [-7.88461674e-02,  3.77384390e-01, -3.29965747e-01, -2.68656059e-01,
           3.05959000e-01,  6.84951804e-02],
         [ 2.66433871e-01,  1.32105123e-01, -1.00174059e-01, -1.22484293e-01
          -1.95005245e-04, -3.00747194e-01]] )
        b1= np.array(
        [[-0.18902477,  0.26616478, -0.58388113,  0.15024495,  0.34718585]] )
        b2= np.array(
        [[ 0.24120954, -0.35012968,  0.36565066, -0.33204061, -0.3637446,   0.11747195]] )
        W3= np.array(
        [[-166.67442966, -176.36661041,  214.21194898],
         [-200.98035438, -170.46284151,   88.09615513],
         [-284.39743615, -225.12258542,   39.20322492],
         [ -99.0795809,  -238.65059309,   35.56538518],
         [-145.23419817, -328.32390926,   52.25935277],
         [-218.2863453,  -292.47248121,  -17.29103179]] )
        b3= np.array(
        [[-462.49894798, -349.44592597,  161.56566049]] )
        W4= np.array(
        [[-0.82852095, -0.86516986,  1.11651803],
         [-0.97066463, -0.82993677,  0.53913355],
         [-1.33239991, -1.06486568,  0.30778726],
         [-0.48860814, -1.10332135,  0.24712574],
         [-0.71574986, -1.52157071,  0.36492254],
         [-1.0374955,  -1.36115387,  0.05349558]] )
        b4= np.array(
        [[-2.19592491, -1.68490543,  0.99393123]] )

    if(14<a<21)and(14<b<21):
        W1= np.array(
        [[-0.69583793,  0.67371038, -0.6122816,   0.51486604,  0.22525614],
         [ 0.01593282,  0.34028825,  0.31914796,  0.32335342, -0.24912613]] )
        W2= np.array(
        [[-0.29838662,  0.08296493, -0.32933616, -0.15658714,  0.40490101,  0.34459025],
         [-0.32758178, -0.12473187,  0.19921223,  0.28349277,  0.12044147,  0.41377656],
         [-0.18059339, -0.39568688, -0.36158785,  0.37522971, -0.38153492, -0.04532306],
         [-0.27880142, -0.36067175,  0.30056773,  0.10582196,  0.22168845,  0.01653681],
         [ 0.13985795, -0.19849847, -0.21987654, -0.35883439,  0.23159117, -0.0486061 ]] )
        b1= np.array(
        [[-0.02983722,  0.06173783, -0.23968622,  0.54982311,  0.09723406]] )
        b2= np.array(
        [[-0.28977528, -0.23108659, -0.33325855,  0.14855405,  0.33673422,  0.08959898]] )
        W3= np.array(
        [[-190.64151297, -259.75028148,  -57.46068742],
         [-236.66234418, -269.20121851,   16.3215175 ],
         [-224.83054481, -278.31978616,   93.93229522],
         [-259.10408921, -238.6509391,   -84.36001039],
         [-318.7129904, -347.89339506,   83.67805035],
         [-259.49912324,  -88.28955197,  127.10705317]] )
        b3= np.array(
        [[-294.75228214, -323.72075181,  240.18266664]] )
        W4= np.array(
        [[-0.88407728, -1.19201808, -0.17961274],
         [-1.08876698, -1.23480096,  0.14894907],
         [-1.06230324, -1.30242036,  0.54582602],
         [-1.22384765, -1.13699758, -0.22374053],
         [-1.49886709, -1.63237254,  0.54305212],
         [-1.22888389, -0.47455931,  0.71949416]] )
        b4= np.array(
        [[-1.43204478, -1.56658728,  1.31670012]] )

    if(14<a<21)and(0<=b<7):
        W1= np.array(
        [[ 4.22982993e-01,  4.84455817e-01,  5.48715869e-01, -2.75760467e-01,
           3.10516937e-01],
         [ 4.08833987e-01,  3.36851617e-01, -1.42295342e-04, -5.73284367e-01,
           3.70283401e-01]] )
        W2= np.array(
        [[ 0.0949032,   0.01576899, -0.17586469,  0.07477155, -0.36313668,  0.207647  ],
         [-0.21654945,  0.21305885, -0.31741031,  0.31779227, -0.38108451,  0.14546058],
         [ 0.09770771,  0.39333087, -0.22978173,  0.25517376,  0.10967256,  0.00239131],
         [ 0.03292779, -0.02394191,  0.04186827, -0.27017589, -0.0778021,   0.25680285],
         [-0.15142656, -0.07917966,  0.10769416,  0.2429684,  -0.15508016,  0.18060173]] )
        b1= np.array(
        [[ 0.11237509, -0.50506704, -0.33924726, 0.22205388, -0.31485564]] )
        b2= np.array(
        [[ 0.13795234,  0.20998226,  0.23111443,  0.1364405,  -0.00408388,  0.14906939]] )
        W3= np.array(
        [[-271.32531124, -318.14330299,   54.16298097],
         [-362.51751485, -341.50584233,  -16.31226726],
         [-226.80144873, -266.08103684,   84.48181026],
         [-158.5949856,  -211.49322906,  134.40096254],
         [-264.6380171,   -43.12059895, -154.53251117],
         [-316.22494721, -275.73220037,   43.53981068]])
        b3= np.array(
        [[-213.211167,   -241.41902093,  235.01589989]] )
        W4= np.array(
        [[-1.25971315, -1.46808562,  0.35051219],
         [-1.68510467, -1.59348731,  0.08188532],
         [-1.05276874, -1.22757587,  0.46506676],
         [-0.78840948, -1.02422655,  0.76223336],
         [-1.20967561, -0.22932569, -0.61493471],
         [-1.47840104, -1.30047879,  0.34352703]] )
        b4= np.array(
        [[-1.06037122, -1.18740243,  1.26855138]] )

    if(14<b<21)and(0<=a<7):
        W1= np.array(
        [[ 0.09496502, -0.41002743, -0.67503445,  0.5002457,   0.33800503],
         [ 0.16773336,  0.25985111, -0.57317392, -0.23044688,  0.22479939]])
        W2= np.array(
        [[-0.41749964,  0.00351835, -0.09141968,  0.34395808,  0.18018837, -0.05476338],
         [-0.04171768,  0.12502271, -0.08517277,  0.18238497,  0.40780271, -0.23158851],
         [-0.27125153,  0.05533022,  0.21694772, -0.19615077,  0.24676532, -0.05881504],
         [ 0.02516637, -0.20029013,  0.27779429,  0.27205488, -0.25262754, -0.05956363],
         [-0.01419855, -0.35145041,  0.20100314, -0.3331787,  -0.2266747,  -0.42173968]])
        b1= np.array(
        [[-0.30674979, -0.23915842,  0.41161536, -0.48313221,  0.60753563]])
        b2= np.array(
        [[ 0.15997358,  0.21807074,  0.24478667,  0.36896114,  0.21618505, -0.40167294]])
        W3= np.array(
        [[-164.59641499, -266.43263977,  -80.33393551],
         [-225.95906946, -138.75477742,   49.222473  ],
         [-268.18941919, -181.34876812,  -49.54620558],
         [-342.30143975, -155.94850688,  143.62475682],
         [-295.77001463, -425.59884673,   -3.22059571],
         [ -37.53715374,  -79.38082041,   26.27085005]])
        b3= np.array(
        [[-266.03351636, -272.67498461,  393.76782218]])
        W4= np.array(
        [[-0.77852087, -1.24608741, -0.24664639],
         [-1.05748757, -0.69039421,  0.34406018],
         [-1.25315291, -0.89071462, -0.0730104 ],
         [-1.58807608, -0.78726552,  0.79821278],
         [-1.38153871, -1.98077796,  0.14677157],
         [-0.19611344, -0.39110051,  0.17913306]])
        b4= np.array(
        [[-1.29070752, -1.35872006,  2.00090335]])    
    
    #Forward
    t1= x@W1 + b1
    h1= sigmoid(t1)
    t2= h1@W2 + b2
    h2= sigmoid(t2)
    t4= h2@W4 + b4
    h4=softmax(t4)
    t3= h2@W3 + b3
    z=softmax(t3)
    return z
    
class_names=['1) Т_ц=60сек, t_з=30сек','2) Т_ц=120сек, t_з=60сек','3) Т_ц=240сек, t_з=120сек']

probs= predict(9,5)
pred_class= np.argmax(probs)
print('Pred_class= ',pred_class)
print('PREDICT светофор ',class_names[pred_class])

probs= predict(4,3)
pred_class= np.argmax(probs)
print('Pred_class= ',pred_class)
print('PREDICT светофор ',class_names[pred_class])

probs= predict(7,7)
pred_class= np.argmax(probs)
print('Pred_class= ',pred_class)
print('PREDICT светофор ',class_names[pred_class])

probs= predict(20,20)
pred_class= np.argmax(probs)
print('Pred_class= ',pred_class)
print('PREDICT светофор ',class_names[pred_class])

probs= predict(20,8)
pred_class= np.argmax(probs)
print('Pred_class= ',pred_class)
print('PREDICT светофор ',class_names[pred_class])

